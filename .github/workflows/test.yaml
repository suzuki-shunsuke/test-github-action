---
name: test
on: pull_request
jobs:
  tflint:
    timeout-minutes: 30
    runs-on: ubuntu-latest
    permissions:
      contents: read
      pull-requests: write
    steps:
      - uses: actions/checkout@v4
      - uses: aquaproj/aqua-installer@v3.0.1
        with:
          aqua_version: v2.31.0
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      - uses: suzuki-shunsuke/github-action-tflint@v1.1.0
        with:
          working_directory: terraform
          github_comment: true
        env:
          GH_COMMENT_VAR_wd: terraform
      - run: |
          github-comment hide -k tflint -var "wd:$ENV"
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          ENV: terraform
